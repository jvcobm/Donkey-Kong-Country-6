<!doctype html>
<body>
    <canvas id="gameCanvas" width="400" height="600"></canvas>
</body>


<html>
<style>
    html{
        background-color:white;
    }
    
    canvas{
        border: 2px solid black;
    }
</style>
</html>



<script src='player.js'></script> 
<script src='Pipe.js'></script>

<script>
var canvas, canvasContext;
    
window.onload = function(){
    canvas = document.getElementById('gameCanvas');
    canvasContext = canvas.getContext('2d');
    
    document.addEventListener('keydown', keyPressed);
    document.addEventListener('keyup', keyReleased);
    
    setInterval(mainLoop, 1000/60 );
}
//Inputs
    const SPACE_KEY = 32;
    var spaceKeyPressed = false;
    
// Player Variables
    var players =[];
    var playerTotal = 1;
    var gravity = 0.25;
    var jump = false;
    var jHeight = -4.6;
    var ppY = 0;
    var ppW = 0;
    var ppH = 0;
    
// Pipe Variables
    var pipes =[];
    var pipeTotal = 1;
    
// Set up Variables
    var setUp = true;
    var gameOver = false;
    
function mainLoop(){
        
        colorRect(0,0,canvas.width,canvas.height,'white'); // Background
        
        dead();    
    
        if(setUp){
            settingUp();
            setUp = false;
        }
    
        if(players.length > 0){
            players.forEach(function(player,index){
              player.drawPlayer();  
              player.pJump();
              player.pFall();
              player.pMove();
              player.updateYpos();
            });
        }
    
        if(pipes.length > 0){
            pipes.forEach(function(Pipe,index){
                Pipe.drawPipe();
                Pipe.pipeMove();
                Pipe.pipeHit();
            });
        }
}
    
    
// Color Rect for drawing canvas and objects
function colorRect(x,y,w,h,color){ 
        canvasContext.fillStyle = color;
        canvasContext.fillRect(x,y,w,h);
}
//Space Key Detection
    function keyPressed(evt) {
        if(evt.keyCode == SPACE_KEY){
            jump = true;
            spaceKeyPressed = true;
            
            if(gameOver){
                settingUp(); 
                gameOver = false;
            }
        }
    }   
    
      function keyReleased(evt) {
        if(evt.keyCode == SPACE_KEY){
            spaceKeyPressed = false;
        }
      }
    
// Player Class
function makePlayer(){ // player movement and shit
        
            var pWidth = 30;
            const pHeight = 30;
            var pXpos = canvas.width / 3;
            var pYpos = ppY;
            var pYspeed = 0;
            var pColor = 'brown';
    
            var p = new Player (pXpos,pYpos,pWidth,pHeight,pColor,pYspeed);
            players.push(p);
    
    }

    
function makePipe(){
    
    const pipeWidth = 70;
    var pipeHeight = 200;
    var pipeXpos = canvas.width - pipeWidth;
    var pipeYpos = 0;
    var pipeColor = 'green';
    var pipeXspeed = -3;
    var pipeGap = 90;
    var pipeBottomY = pipeYpos + pipeHeight + pipeGap;
    
    var pipe = new Pipe(pipeXpos,pipeYpos,pipeBottomY,pipeWidth,pipeHeight,pipeColor,pipeXspeed,pipeGap);
    
    pipes.push(pipe);        
}

function settingUp(){
            for (i=0; i < playerTotal; i++){
                makePlayer();
                gameOver = false;
            }
    
            for (i=0; i < pipeTotal; i++){
                makePipe();
            }
}

function dead(){
    if(gameOver){
        delete players[0];
        delete pipes[0];
    }
}
    
</script>